---
  - hosts: localhost
    collections: 
    - netapp.ontap
    gather_facts: false
    tasks:
      - name: change nfs status
        na_ontap_nfs:
          state: absent          
          service_state: stopped
          vserver: "{{ vservername }}"
          hostname: "{{ netapp_hostname }}"
          username: "{{ netapp_username }}"
          password: "{{ netapp_password }}"         
          nfsv3: disabled
          nfsv4: disabled
          nfsv41: disabled
          tcp: disabled
          udp: disabled
          vstorage_state: disabled
          validate_certs: false
          https: true
      - name: Delete SVM Route
        na_ontap_net_routes:
          state: absent
          vserver: "{{ vservername }}"
          hostname: "{{ netapp_hostname }}"
          username: "{{ netapp_username }}"
          password: "{{ netapp_password }}"
          destination: 0.0.0.0/0
          gateway: "{{ gateway }}"
          validate_certs: false
          https: true          
      - name: delete default rules
        na_ontap_export_policy_rule:
          state: absent
          policy_name: default
          vserver: "{{ vservername }}"
          client_match: 0.0.0.0/0
          hostname: "{{ netapp_hostname }}"
          username: "{{ netapp_username }}"
          password: "{{ netapp_password }}"         
          ro_rule: any
          rw_rule: any
          super_user_security: none
          validate_certs: false
          https: true          
      - name: Delete interface
        na_ontap_interface:
          state: absent
          interface_name: "{{ vservername }}_lif1"
          home_port: e0a
          home_node: useclnsnp101-01-01
          role: data
          protocols: nfs
          admin_status: down
          failover_policy: local-only
          is_auto_revert: true
          hostname: "{{ netapp_hostname }}"
          username: "{{ netapp_username }}"
          password: "{{ netapp_password }}"           
          address: "{{ address }}"
          netmask: "{{ netmask }}"
          vserver: "{{ vservername }}"
          validate_certs: false
          https: true          
      - name: Delete SVM
        na_ontap_svm:
          state: absent
          name: "{{ vservername }}"
          root_volume: "{{ vservername }}_root"
          root_volume_aggregate: "{{ aggregate }}"
          root_volume_security_style: unix
          hostname: "{{ netapp_hostname }}"
          username: "{{ netapp_username }}"
          password: "{{ netapp_password }}"
          allowed_protocols: nfs,cifs
          validate_certs: false
          https: true
